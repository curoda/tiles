<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sliding Puzzle Game</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

    body {
      background-color: #f2f2f2;
    }

    .screen-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      width: 100%;
    }

    .hidden {
      display: none !important;
    }

    /* Start Screen */
    #start-screen h1 {
      font-size: 2em;
      margin-bottom: 1em;
      color: #c62828;
    }

    #start-screen input {
      font-size: 1em;
      padding: 0.5em;
      width: 200px;
      margin-bottom: 1em;
      text-align: center;
    }

    #start-screen button {
      font-size: 1.2em;
      padding: 0.7em 1.2em;
      background-color: #c62828;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #start-screen button:hover {
      background-color: #b71c1c;
    }

    /* Game Screen */
    #game-screen {
      padding: 1em;
      background: #e0f7fa;
    }

    header h2 {
      font-size: 1.5em;
      margin-bottom: 0.5em;
      color: #c62828;
    }

    #timer {
      font-size: 1.2em;
      color: #004d40;
    }

    .puzzle-container {
      width: 90vw;
      max-width: 400px;
      height: 90vw;
      max-height: 400px;
      position: relative;
      margin: 0 auto;
      border: 2px solid #ccc;
      border-radius: 10px;
      overflow: hidden;
      background: #fff;
    }

    .tile {
      position: absolute;
      transition: transform 0.3s ease;
      background-size: 400% 400%;
      background-repeat: no-repeat;
      cursor: pointer;
    }

    .empty-tile {
      background: none;
      cursor: default;
    }

    /* Win Overlay */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .overlay-content {
      background: #fff;
      color: #000;
      padding: 2em;
      text-align: center;
      border-radius: 10px;
      width: 80%;
      max-width: 400px;
    }

    .overlay-content h2 {
      font-size: 1.8em;
      margin-bottom: 0.5em;
    }

    .overlay-content p {
      margin-bottom: 1em;
      font-size: 1.2em;
    }

    .overlay-content button {
      font-size: 1em;
      padding: 0.7em 1.2em;
      background-color: #006064;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .overlay-content button:hover {
      background-color: #004d40;
    }
  </style>
</head>
<body>
  <!-- Start Screen -->
  <div id="start-screen" class="screen-container">
    <h1>Welcome to the Puzzle Game!</h1>
    <input type="text" id="username" placeholder="Enter your name" />
    <button id="start-btn">Start Game</button>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="screen-container hidden">
    <header>
      <h2>Solve the puzzle, claim your prize!</h2>
      <div id="timer">00:00</div>
    </header>
    <div id="puzzle-container" class="puzzle-container"></div>
  </div>

  <!-- Win Overlay -->
  <div id="win-overlay" class="overlay hidden">
    <div class="overlay-content">
      <h2 id="overlay-message">Congratulations!</h2>
      <p id="overlay-time"></p>
      <button id="play-again-btn">Play Again</button>
    </div>
  </div>

  <script>
    let puzzle = [];
    let emptyIndex = 15;
    let timerInterval;
    let startTime;

    const puzzleContainer = document.getElementById('puzzle-container');
    const timerDisplay = document.getElementById('timer');
    const startScreen = document.getElementById('start-screen');
    const gameScreen = document.getElementById('game-screen');
    const winOverlay = document.getElementById('win-overlay');
    const overlayMessage = document.getElementById('overlay-message');
    const overlayTime = document.getElementById('overlay-time');

    document.getElementById('start-btn').addEventListener('click', () => {
      puzzle = Array.from({ length: 15 }, (_, i) => i).concat('empty');
      emptyIndex = 15;
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 1000);
      startScreen.classList.add('hidden');
      gameScreen.classList.remove('hidden');
      shufflePuzzle();
      renderPuzzle();
    });

    document.getElementById('play-again-btn').addEventListener('click', () => {
      winOverlay.classList.add('hidden');
      startScreen.classList.remove('hidden');
      clearInterval(timerInterval);
    });

    function renderPuzzle() {
      puzzleContainer.innerHTML = '';
      const containerWidth = puzzleContainer.offsetWidth;
      const containerHeight = puzzleContainer.offsetHeight;
      const tileWidth = containerWidth / 4;
      const tileHeight = containerHeight / 4;

      puzzle.forEach((tile, index) => {
        const tileDiv = document.createElement('div');
        tileDiv.classList.add('tile');

        if (tile === 'empty') {
          tileDiv.classList.add('empty-tile');
        } else {
          const row = Math.floor(tile / 4);
          const col = tile % 4;
          tileDiv.style.backgroundPosition = `${col * 25}% ${row * 25}%`;
          tileDiv.style.backgroundSize = '400% 400%';
        }

        tileDiv.style.width = `${tileWidth}px`;
        tileDiv.style.height = `${tileHeight}px`;

        const row = Math.floor(index / 4);
        const col = index % 4;
        tileDiv.style.transform = `translate(${col * tileWidth}px, ${row * tileHeight}px)`;

        tileDiv.addEventListener('click', () => moveTile(index));
        puzzleContainer.appendChild(tileDiv);
      });
    }

    function shufflePuzzle() {
      do {
        for (let i = puzzle.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [puzzle[i], puzzle[j]] = [puzzle[j], puzzle[i]];
        }
      } while (!isSolvable());
    }

    function isSolvable() {
      let inversions = 0;
      const flatPuzzle = puzzle.filter(v => v !== 'empty');
      for (let i = 0; i < flatPuzzle.length; i++) {
        for (let j = i + 1; j < flatPuzzle.length; j++) {
          if (flatPuzzle[i] > flatPuzzle[j]) inversions++;
        }
      }
      const blankRow = Math.floor(emptyIndex / 4);
      return (inversions % 2 === 0) === (blankRow % 2 === 1);
    }

    function moveTile(tileIndex) {
      if (isAdjacent(tileIndex, emptyIndex)) {
        [puzzle[tileIndex], puzzle[emptyIndex]] = [puzzle[emptyIndex], puzzle[tileIndex]];
        emptyIndex = tileIndex;
        renderPuzzle();
        if (checkWin()) endGame();
      }
    }

    function isAdjacent(index1, index2) {
      const row1 = Math.floor(index1 / 4);
      const col1 = index1 % 4;
      const row2 = Math.floor(index2 / 4);
      const col2 = index2 % 4;
      return (
        (row1 === row2 && Math.abs(col1 - col2) === 1) ||
        (col1 === col2 && Math.abs(row1 - row2) === 1)
      );
    }

    function checkWin() {
      return puzzle.slice(0, 15).every((tile, i) => tile === i);
    }

    function endGame() {
      clearInterval(timerInterval);
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      overlayMessage.textContent = "You solved it!";
      overlayTime.textContent = `Time: ${Math.floor(elapsed / 60)}:${elapsed % 60}`;
      winOverlay.classList.remove('hidden');
    }

    function updateTimer() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      timerDisplay.textContent = `${Math.floor(elapsed / 60).toString().padStart(2, '0')}:${(elapsed % 60).toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
